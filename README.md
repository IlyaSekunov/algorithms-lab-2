# Лабораторная работа по алгоритмам и структурам данных №2

  

<h2>Задача</h2>

На вход подается N прямоуголньников и M точек. Необходимо как можно быстрее узнать, скольким прямоуголникам каждая точка принадлежит. Тестируются следующие 3 алгоритма:

  

<h2>Алгоритм перебора (1)</h2>

Для каждой точки мы перебираем все прямоуголники, и если координаты данной точки принадлежат прямоуголнику, то увеличиваем счетчик.

  

<h3>Сложности</h3>

Сложность предподгтовки - $O(1)$</br>

Сложность поиска ответа для одной точки - $O(N)$</br>

Суммарная сложность алгоритма - $O(MN)$</br>

<h2>Алгоритм сжатия координат и построение карты (2)</h2>

Данный алгоритм подразумевает сделать предподготовку данных прежде чем сразу отвечать на вопрос для каждой точки. Во-первых, необходимо получить все уникальные координаты прямоугольников по оси ординат и абсцисс в отсортированном порядке. Имея два таких массива, мы строим двумерную матрицу, в ячейке $A[i][j]$ которой должно лежать количество прямоуголников, которые покрывают данную область. Индекс i здесь обозначает индекс в массиве уникальных значений координат по оси ординат, где $A[i]$ и $A[i + 1]$ - область, в которой мы хотим почситать количество прямоуголников. То же самое и для индекса j, только для оси абсцисс. Далее, имея такую матрицу, мы проходимся по всем точкам, и бинарным поиском ищем индекс в этих двух массивах и смотрим значение по этим индексам в построенной ранее карте.

  
<h3>Сложности</h3>

Сложность предподгтовки - $O(N^3)$</br>

Сложность поиска ответа для одной точки - $O(logN)$</br>

Суммарная сложность алгоритма - $O(N^3 + MlogN)$</br>

<h2>Алгоритм с использованием персистентного дерева отрезков (3)</h2>

Алгоритм также подразумевают предподготовку. Также необходимо получить два отсортированных массива с уникальными координатами и построить персистентное дерево отрезков. Количество листьев персистеного дерева отрезков будет равное количеству уникальных значений по оси ординат. Далее мы проходимся по прямоугольникам, одновременно формирую уникальный отсортированный массив значений по оси абсцисс и заполняя информацию, на каком значении $X$ и каких границах $Y$ прибавилось количество прямоугольников или убавилось. Далее, имея данную информацию мы строим дерево, где на отрезке $y1-y2$ прибавляем +1 или -1. Тем самым количество стейтов дерева отрезков, будет равно количеству модификация при $X$. Далее для каждой точки находим бинарным поиском нужный индекс по $x$ и по $y$, где $x$ - нужная версия персистентного дерева, а $y$ - индекс в дереве, на котором нужно найти значение.

<h3>Сложности</h3>

 Сложность подготовки - $O(logN)$</br>

Сложность поиска ответа для одной точки - $O(logN)$</br>

Суммарная сложность алгоритма - $O(NlogN + MlogN)$</br>

